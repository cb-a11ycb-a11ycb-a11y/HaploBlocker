{
    "collab_server" : "",
    "contents" : "seg <- 2\nphg_full <- NULL\nposition_full <- NULL\n\nfor(seg in 1:15){\n  library(readr)\n  name <- paste0(\"C:/Users/tpook/Desktop/raw\", seg, \"plink.ped\")\n  phg1 <- read_delim(name, \" \", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)\n  linenames_raw <- as.matrix(phg1[,1])\n  phg_raw <- as.matrix(phg1[sort(linenames_raw, index.return=TRUE)$ix,])\n  linenames_raw <- sort(linenames_raw)\n  \n  name <- paste0(\"C:/Users/tpook/Desktop/raw\", seg, \"plink.map\")\n  position_raw <- read_delim(name, \"\\t\", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)\n  position_raw <- as.numeric(as.matrix(position_raw)[,4])\n  \n  \n  phg <- t(as.matrix(phg_raw[,-(1:6)]))\n  phg <- (phg[1:(nrow(phg)/2)*2,])\n  \n  phg_full <- rbind(phg_full, phg)\n  position_full <- c(position_full, position_raw)\n  \n}\nphg <- phg_full\nposition <- position_full \n\nmissing_rate <- numeric(nrow(phg))\nvariants <- numeric(nrow(phg))\nfor(index in 1:nrow(phg)){\n  missing_rate[index] <- sum(phg[index,]==0)/306\n  variants[index] <- length(unique(phg[index,]))\n}\n\n\nnsnp <- (sum(variants==3))\npsnp <- which(variants==3)\nv1p <- NULL\nv2p <- NULL\nv3p <- NULL\n\ndata <- matrix(0, nrow=nsnp, ncol=9)\ntransition <- matrix(0, nrow=nsnp, ncol=9)\nfor(index in 1:nsnp){\n  vari <- unique(c(\"0\", phg[psnp[index],]))\n  v1 <- sum(phg[psnp[index],]==vari[1])\n  v1w <- which(phg[psnp[index],]==vari[1])\n  v2 <- sum(phg[psnp[index],]==vari[2])\n  v2w <- which(phg[psnp[index],]==vari[2])\n  v3 <- sum(phg[psnp[index],]==vari[3])\n  v3w <- which(phg[psnp[index],]==vari[3])\n  miss_ad <- mean(missing_rate[psnp[index]+(-10):10]) * 306\n  \n  data[index,] <- c(psnp[index], position[psnp[index]], vari, v1,v2,v3, miss_ad)\n  if(v2<v3){\n    data[index,] <- c(psnp[index], position[psnp[index]], vari[c(1,3,2)], v1,v3,v2, miss_ad)\n    temp1 <- v3w\n    v3w <- v2w\n    v2w <- temp1\n  }\n  transition[index,1] <- length(intersect(v1w,v1p))\n  transition[index,2] <- length(intersect(v1w,v2p))\n  transition[index,3] <- length(intersect(v1w,v3p))\n  transition[index,4] <- length(intersect(v2w,v1p))\n  transition[index,5] <- length(intersect(v2w,v2p))\n  transition[index,6] <- length(intersect(v2w,v3p))\n  transition[index,7] <- length(intersect(v3w,v1p))\n  transition[index,8] <- length(intersect(v3w,v2p))\n  transition[index,9] <- length(intersect(v3w,v3p))\n  v1p <- v1w\n  v2p <- v2w\n  v3p <- v3w\n  }\n\n#shortening\n\ncommon <- numeric(nrow(phg))\nfor(index in 1:nrow(phg)){\n  common[index] <- unique(c(\"0\",phg[index,]))[2]\n}\ncommon[psnp] <- data[,4]\ndata[,4] <- substr(data[,4], start=1, stop = 5)\ndata[,5] <- substr(data[,5], start=1, stop = 5)\nnch <- numeric(nsnp)\nfor(index in 1:nsnp){\n  nch[index] <- nchar(data[index,3]) + nchar(data[index,4])\n}\n\nplot(data[,6], data[,9])\npoints(data[nch>5,5], data[nch>5,8], col=\"red\")\n\nrange <- 1001:2000 + 12000\nplot(position[range], missing_rate[range])\nabline(v=which(variants[range]==3))\n\n\n",
    "created" : 1509037006025.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "3765602563",
    "id" : "18CE6081",
    "lastKnownWriteTime" : 3275086901999450453,
    "last_content_update" : 1509051979109,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled29"
    },
    "relative_order" : 23,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}