{
    "collab_server" : "",
    "contents" : " cutoff2 = 500\n bound_weighted=TRUE\n type=\"snp\" \n size <- blocklist_size(blocklist)\n  se <- blocklist_startend(blocklist, type=type)\n  nwindow <- max(blocklist_startend(blocklist, type=\"window\"))\n  \n  bpstart <- se[,1]\n  bpend <- se[,2]\n  \n  switch <- sort(bpstart, decreasing=FALSE, index.return=TRUE)$ix\n  start <- bpstart[switch]\n  end <- bpend[switch]\n  size <- size[switch]\n  X11(width=20, height=12)\n  plot(-100000,-100, xlim=c(1,sum(size)), ylim=c(0, max(end)), ylab=\"SNP\", xlab=\"\",xaxt=\"n\",\n       cex.axis=1.5, cex.lab=1.5)\n  current_value <- 1\n  for(index in 1:length(start)){\n    polygon(c(current_value,current_value+size[index], current_value+ size[index],current_value), c(start[index], start[index], end[index], end[index]))\n    current_value <- current_value + size[index]\n  }\n  \n  if(bound_weighted==TRUE){\n    tempest <- numeric(sum(size)*2)\n    sofar <- 0\n    for(index in 1:length(start)){\n      tempest[1:size[index]+sofar] <- start[index]\n      sofar <- sofar + size[index]\n    }\n    for(index in 1:length(start)){\n      tempest[1:size[index]+sofar] <- end[index]\n      sofar <- sofar + size[index]\n    }\n    xy <- density(tempest,bw=5, from=1, to=max(se), n=nwindow)\n    \n    candidate <- unique(c(0,(c(0,xy$y[-nwindow])<c(xy$y)) * (c(xy$y)>c(xy$y[-1],0)) * (xy$y > 1/length(start)/2/5/2*cutoff2) * 1:nwindow))[-1]\n    \n    abline(h=candidate)\n  } else{\n    xy <- density(c(start,end),bw=5, from=1, to=nwindow, n=nwindow)\n    \n    candidate <- unique(c(0,(c(0,xy$y[-nwindow])<c(xy$y)) * (c(xy$y)>c(xy$y[-1],0)) * (xy$y > 1/length(start)/2/5/2*cutoff2) * 1:nwindow))[-1]\n    \n    abline(h=candidate)\n  }\n\n\n savePlot(\"C:/Users/tpook/Desktop/blocklist_chicken.png\", type=\"png\")\n \n \n X11(width=20, height = 12)\nindi=256\ntype=\"snp\"\nbw=500\nse <- blocklist_startend(blocklist, type=type)\n   size <- blocklist_size(blocklist)/indi\n   plot(0,-100, xlim=c(0, max(se[,2])), ylim=c(0, 1), ylab=\"Size/Coverage\", xlab=\"SNP\", main=\"\", cex.axis=1.5, cex.lab=1.5)\n   for(index in 1:length(blocklist)){\n     lines(se[index,c(1,2,2,1,1)],c(0,0,size[index], size[index],0), lwd=1.2)\n   }\n   cov <- rowMeans(coverage_test(blocklist, indi = indi, type=type))\n   lines(ksmooth(1:length(cov), cov, bandwidth = bw), col=\"red\", lwd=2)\n   \n \n savePlot(file=\"C:/Users/tpook/Desktop/block_plot.png\", type=\"png\")\n",
    "created" : 1506073637778.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "3289696443",
    "id" : "19616D1C",
    "lastKnownWriteTime" : 1502098311,
    "last_content_update" : 1506082086789,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled18"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}