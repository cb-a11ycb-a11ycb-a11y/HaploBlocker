{
    "collab_server" : "",
    "contents" : "# Experimental GBLUP\nargs <- commandArgs(TRUE)\n#args <- c(\"B73v4\", 1, \"KE\", 0.01, 0)\nref <- args[1]\nmode <- as.numeric(args[2])\nfamily <- args[3]\nmaf <- as.numeric(args[4])\nmin_sub <- as.numeric(args[5])\n\n\nload(paste0(\"Datasets_DHS1_GWAS/gpimp_haplo_KlimaFit_S1s_DHsF2AsRef_Beagle4.1_\",ref,\"_v2.RData\"))\n\nlibrary(HaploBlocker)\ndata <- as.matrix(gpimp$geno)\nstorage.mode(data) <- \"integer\"\ndata <- t(data)\nblockdata <- NULL\nreport <- NULL\n\nfor(chromo in 1:10){\n\n  take <- which(gpimp$map[,1]==chromo)\n  data1 <- data[take,]\n  maf_filter <- round(ncol(data1) * maf)\n  subgroups <- list(which(gpimp$covar$family==\"KE\"), which(gpimp$covar$family==\"LL\"), which(gpimp$covar$family==\"PE\"))\n  if(mode==1){\n    blockl <- block_calculation(data1, edge_min = maf_filter, node_min = maf_filter,\n                                subgroups = subgroups, min_per_subgroup = min_sub)\n  } else if(mode==2){\n    blockl <- block_calculation(data1, window_size=c(5,10,20,50), min_majorblock = 1, edge_min = maf_filter, node_min = maf_filter,\n                                subgroups = subgroups, min_per_subgroup = min_sub)\n  } else if(mode==3){\n    blockl <- block_calculation(data1, min_majorblock = 20000, edge_min = maf_filter, node_min = maf_filter,\n                                subgroups = subgroups, min_per_subgroup = min_sub)\n  } else if(mode==4){\n    blockl <- block_calculation(data1, adaptive_mode = TRUE, edge_min = maf_filter, node_min = maf_filter,\n                                subgroups = subgroups, min_per_subgroup = min_sub)\n  }\n\n  t <- coverage_test(blockl)\n  t2 <- coverage_test(blockl, max=Inf)\n  se <- blocklist_startend(blockl)\n  size <- blocklist_size(blockl)\n  report <- rbind(report, c(length(blockl), mean(t), mean(t2), mean(se[,2]-se[,1]+1), mean(size)))\n\n\n  chromo_block <- block_matrix_construction(blockl)\n\n  blockdata <- rbind(blockdata, chromo_block)\n  name1 <- paste0(\"Block_OverlapMarkers/Ref\", ref, \"mode\", mode, \"chromo\", chromo, \"maf\" ,maf,\"minsub\", min_sub,\".RData\")\n  save(file=name1, list=c(\"blockl\"))\n}\ncolnames(report) <- c(\"Nr. of blocks\", \"Coverage\", \"Coverage+Overlap\", \"BlockLength\", \"BlockSize\")\nname1 <- paste0(\"Block_OverlapMarkers/Ref\", ref, \"mode\", mode, \"chromo\", chromo, \"maf\" ,maf, \"minsub\", min_sub, \"_blockmatrix.RData\")\nsave(file=name1, list=c(\"blockdata\"))\nname1 <- paste0(\"Block_OverlapMarkers/Ref\", ref, \"mode\", mode,  \"chromo\", chromo, \"maf\" ,maf, \"minsub\", min_sub, \"_report.txt\")\nwrite.table(file=name1, report)\n",
    "created" : 1525851049817.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3641962452",
    "id" : "FBCA924D",
    "lastKnownWriteTime" : 1525862360,
    "last_content_update" : 1525862360782,
    "path" : "C:/Users/tpook/Desktop/Mayer_blockdata_subgroups.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled71"
    },
    "relative_order" : 40,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}