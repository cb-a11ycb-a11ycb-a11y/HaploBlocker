{
    "collab_server" : "",
    "contents" : "a <- scan(\"C:/Users/tpook/Desktop/raw2.vcf\", nlines=1, what=\"character\", skip=712)\nb <- scan(\"C:/Users/tpook/Desktop/raw2.vcf\", nlines=1, what=\"character\", skip=713)\n\nad <- as.numeric(substr(a[10:315], start=3, stop=3))\nbd <- as.numeric(substr(b[10:315], start=3, stop=3))\nad[is.na(ad)] <- 0\nbd[is.na(bd)] <- 0\nwhich(ad>0)\n\nseg <- 2\nname <- paste0(\"C:/Users/tpook/Desktop/raw\", seg, \"plink.ped\")\nphg1 <- read_delim(name, \" \", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)\nlinenames_raw <- as.matrix(phg1[,1])\n\nlinenames_raw[which(ad>0)]\n\n[1] \"B73\"                 \"CML107\"              \"CML465\"              \"CML507\"              \"CML509\"              \"CML512\"             \n[7] \"CML518\"              \"CML532\"              \"CML547\"              \"CML78\"               \"N209\"                \"PHW52\"              \n[13] \"S2FACC\"              \"Tx303\"               \"TZEEI20\"             \"Yellow3-4\"           \"ZEAxppRBFDIAAPEI-3\"  \"ZEAxppRBLDIAAPEI-2\" \n[19] \"ZEAxppRBMDIAAPEI-6\"  \"ZEAxppRBRDIAAPEI-3\"  \"ZEAxppRBSDIAAPEI-4\"  \"ZEAxppRBUDIAAPEI-5\"  \"ZEAxppRCFDIAAPEI-4\"  \"ZEAxppRCUDIAAPEI-1\" \n[25] \"ZEAxppRDHDIAAPEI-12\" \"ZEAxppRDQDIAAPEI-3\"  \"ZEAxujRAGDIBAPE\"     \"ZEAxujRAHDIBAPE\"     \"ZEAxujRAJDIBAPE\"     \"ZEAxujRAKDIBAPE\"    \n[31] \"ZEAxujRAMDIBAPE\"     \"ZEAxujRANDIBAPE\"     \"ZEAxujRAQDIAAPE\"     \"ZEAxujRAYDIAAPE\"     \"ZEAxujRAZDIAAPE\"     \"ZEAxujRBADIAAPE\"    \n[37] \"ZEAxujRBDDIBAPE\"    \n\n# Coverage Development\n\ndepth <- matrix(NA, ncol=7065, nrow=306)\n\nnrow <- 7065\nfor(index in 1:(7065/nrow+1)){\n  a <- scan(\"C:/Users/tpook/Desktop/raw2.vcf\", nlines=nrow, what=\"character\", skip=603+(index-1)*nrow)\n removes <- rep(1:9, nrow) + sort(rep(0:(nrow-1),9)*315)\n  ad <- as.numeric(substr(a[-removes], start=3, stop=3))\n  bd <- (substr(a[-removes], start=4, stop=4))\n  cd <- as.numeric(substr(a[-removes], start=5, stop=5))\n  dd <- as.numeric(substr(a[-removes], start=3, stop=4))\n  double <- which((bd!=\":\")-(bd==\",\")>0)\n  adding <- which(bd==\",\")\n  ad[adding] <- ad[adding] + cd[adding]\n  ad[double] <- dd[double]\n  ad[is.na(ad)] <- 0\n\n  depth[,(index*nrow-nrow+1):(index*nrow)] <- ad\n}\n\n\ndepth0 <- colSums(depth==0)\ndepthavg <- colSums(depth)\ndepth01 <- rowSums(depth[,2300:2700]==0)\n\n\nseg <- 2\nname <- paste0(\"C:/Users/tpook/Desktop/raw\", seg, \"plink.ped\")\nphg1 <- read_delim(name, \" \", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)\nlinenames_raw <- as.matrix(phg1[,1])\nphg_raw <- as.matrix(phg1)\n\nname <- paste0(\"C:/Users/tpook/Desktop/raw\", seg, \"plink.map\")\nposition_raw <- read_delim(name, \"\\t\", escape_double = FALSE, col_names = FALSE, trim_ws = TRUE)\nposition_raw <- as.numeric(as.matrix(position_raw)[,4])\n\n\nphg <- t(as.matrix(phg_raw[,-(1:6)]))\nphg <- (phg[1:(nrow(phg)/2)*2,])\nmissing_rate <- numeric(nrow(phg))\nvariants <- numeric(nrow(phg))\nfor(index in 1:nrow(phg)){\n  missing_rate[index] <- sum(phg[index,]==0)/306\n  variants[index] <- length(unique(phg[index,]))\n}\n\n\nrange <- 5000:6000\nplot(depth0[range])\nabline(v=which(variants[range]==3))\n\nplot(depth[1,range], ylim=c(0,10), type=\"l\")\nfor(index in sample(306,10)){\n  lines(depth[index,range])\n}\n\n\nfor(index in 1:306){\n  for(index2 in 1:50000) print(index2)\n\n  plot(depth[index,range])\n  \n}\n\ncont_depth <- numeric(ncol(depth)-1)\nfor(index in 1:(ncol(depth)-1)){\n  cont_depth[index] <- sum(depth[,index]==depth[,(index+1)])\n}\njump3_depth <- numeric(ncol(depth)-1)\nfor(index in 1:(ncol(depth)-1)){\n  jump3_depth[index] <- sum(abs(depth[,index]-depth[,(index+1)])>2)\n}\n\n\n# Short Inversion\nplot(depth[,110], depth[,111])\ns1jump <- intersect(which(depth[,110]==0), which(depth[,111]>0))\n#[1]   1   3   4   6   8   9  11  14  16  17  18  19  20  21  22  23  24  25  26  30  32  33  34  36  37  38  39  41\n#[29]  42  43  44  47  48  49  50  51  52  53  54  55  59  61  62  64  65  66  67  70  72  73  75  76  77  78  79  80\n#[57]  83  84  86  88  89  91  92  93  94  95  96  97  98  99 101 103 104 106 107 108 109 110 115 116 117 119 121 122\n#[85] 123 124 125 127 128 129 130 131 132 134 135 136 137 139 140 142 143 144 145 146 147 148 150 151 152 153 154 155\n#[113] 156 157 159 161 162 163 165 166 167 168 169 172 175 177 180 181 182 183 184 186 187 188 189 192 193 195 196 197\n#[141] 198 199 201 202 203 204 205 206 207 208 209 210 211 212 214 215 216 217 218 219 220 221 222 223 224 226 229 230\n#[169] 231 233 234 235 236 243 249 252 253 261 262 267 268 269 271 273 274 275 279 282 287 290 291 293 295 296 297 298\n#[197] 299 306\n\nplot(depth[,275], depth[,276])\ns2jump <- intersect(which(depth[,275]==0), which(depth[,276]>0))\n#[1]   1   6  11  16  17  20  23  24  25  26  33  35  37  39  42  43  46  47  48  53  54  56  59  60  61  62  65  66\n#[29]  68  70  74  77  79  81  82  83  84  87  89  94  95  96  98 101 103 106 109 113 114 115 116 117 119 120 122 123\n#[57] 125 127 129 130 131 132 134 135 136 137 139 144 145 151 153 154 155 157 159 161 162 165 167 168 174 175 177 181\n#[85] 182 183 184 187 188 190 192 193 195 196 198 200 203 204 205 206 208 210 211 212 215 219 220 228 232 235 236 239\n#[113] 244 247 248 249 250 254 262 263 267 268 271 272 274 277 279 282 290 294 298 305 306\n\nplot(depth[,382], depth[,383])\ns3jump <- intersect(which(depth[,382]==0), which(depth[,383]>0))\n#[1]   3   7   8   9  13  26  32  49  63  73  93  99 107 108 110 124 138 158 160 163 164 186 199 209 214 218 221 222 223\n#[30] 224 226 230 233 234 242 245 246 251 253 261 264 265 269 280 291 293 295 303\n\nplot(depth[,553], depth[,554])\ns4jump <- intersect(which(depth[,553]==0), which(depth[,554]>0))\n\n\ns12 <- intersect(s1jump,s2jump)\ns13 <- intersect(s1jump,s3jump)\ns14 <- intersect(s1jump,s4jump)\n\nfor(index in 1:306){\n  plot(depth[index,1:600])\n  abline(h=mean(depth[index,depth[index,]!=0]), lwd=2)\n  for(index2 in 1:100000000){}\n}\n\n\nplot(depth[,6758], depth[,6761])\ns5jump <- intersect(which(depth[,6758]==0), which(depth[,6761]>0))\n\n\nplot(depth[,6936], depth[,6937])\ns6jump <- intersect(which(depth[,6936]==0), which(depth[,6937]>0))\n\n",
    "created" : 1509114748289.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "1124119722",
    "id" : "3A095421",
    "lastKnownWriteTime" : 7143307332313677824,
    "last_content_update" : 1510949736859,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled30"
    },
    "relative_order" : 24,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}