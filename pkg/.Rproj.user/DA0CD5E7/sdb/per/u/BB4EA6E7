{
    "collab_server" : "",
    "contents" : "# Error - BEAGLE 4.1\n\n\nerrorm <- matrix(nrow=10,ncol=12)\nfor(chromo in 1:10){\n  col <- 1\n  for(type in c(\"default\",\"buildwindow10\",\"buildwindow50\",\"buildwindow250\", \"nsamples20\", \"nsamples10\", \"nsamples2\",\n                \"phaseits10\", \"phaseits15\", \"beagle4\", \"modelscale1\",\"modelscale15\")){\n    name <- paste0(\"MAZE_new/Imputing_error_total/errorPosi\", chromo, type ,\".RData\")\n    \n    x <- tryCatch(\n      \n      load(name), warning= function(e) e ,error=function(e) e\n    )\n    if(sum(class(x)==\"error\")>0 || sum(class(x)==\"warning\")>0){\n      next\n    }\n    errorm[chromo,col] <- mean(error)\n    col <- col +1\n  }\n}\n\n\n\nfor(nr in 1:50){\n  print(nr)\n  true <- read.table(paste0(\"MAZE_new/PseudoS0_vcf/PseudoS0_chromo\",chromo,\"nr\",nr,\".vcf.vcf\"))\n  imputed <- read.table(paste0(\"MAZE_new/Phased_\",type,\"_vcf/chromo\",chromo,\"_\",nr,\"vcf.vcf.gz\"))\n  \n  overlap <- duplicated(c(imputed[,2],true[,2]))[-(1:nrow(imputed))]\n  \n  \n  true_reduced <- true[overlap,]\n  true_data <- true_reduced[,-(1:9)]\n  imputed_data <- imputed[,-(1:9)]\n  \n  switch <- which(as.character(true_reduced[,4])!=as.character(imputed[,4]))\n  \n  if(nr==1){\n    error <- numeric(ncol(imputed_data)*50)\n  }\n  activ_rows <- which(duplicated(c(true[,2], imputed[,2]))[-(1:nrow(true))])\n  \n  for(indi in 1:ncol(imputed_data)){\n    t1 <- as.numeric(substr(true_data[,indi], start=1, stop=1))\n    t2 <- as.numeric(substr(true_data[,indi], start=3, stop=3))\n    \n    \n    z1 <- as.numeric(substr(imputed_data[,indi], start=1, stop=1))\n    z2 <- as.numeric(substr(imputed_data[,indi], start=3, stop=3))\n    \n    hetero <- which((t1+t2)==1)\n    \n    equally <- t1[hetero]==z1[hetero]\n    \n    error[indi+ncol(imputed_data)*(nr-1)] <- sum(abs(diff(equally)))/length(hetero)\n  }\n  print(mean((error)[1:250+ (nr-1)*250]))\n}\nname <- paste0(\"MAZE_new/Imputing_error_total/errorPosi\", chromo, type ,\".RData\")\nsave(file=name, list=c(\"error\"))\n\n",
    "created" : 1517742340587.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "150446760",
    "id" : "BB4EA6E7",
    "lastKnownWriteTime" : 2315732155208049267,
    "last_content_update" : 1517973576979,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled49"
    },
    "relative_order" : 50,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}