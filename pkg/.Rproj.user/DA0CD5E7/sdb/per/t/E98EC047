{
    "collab_server" : "",
    "contents" : "\nname <- paste0(\"C:/Users/tpook/Desktop/Genetic_Datasets/Batch3_KEPE/\",\"KE\",\"_DH_chromo\",1,\".RData\")\n\n\nload(name)\nlibrary(HaploBlocker)\ndata1 <- data[1:20000,]\nblocklist <- block_calculation(data1)\n\n\npng(file=\"C:/Users/tpook/Desktop/Fig4.png\", width=2250, height=1650, res=300)\npar(ps = 12, cex = 1, cex.main = 1, cex.lab=1, cex.axis=1)\nplot_block(blocklist, indi=501)\ndev.off()\n\n{\n  png(file=\"C:/Users/tpook/Desktop/Fig5.png\", width=2250, height= 1360, res=300)\n  race <- \"KE\"\n  diff <- 1\n  closer <- -0.5\n  par(ps = 12, cex = 1, cex.main = 1, cex.lab=1, cex.axis=1)\n  par(mfrow=c(1,2))\n  par(mar=c(4.6,3.1,2.6,0.1))\n  zwei <- c(4.6,2.6,2.6,0.6)\n#  par(mar=c(4.6,4.1,2.6,0.1))\n#  zwei <- c(4.6,2.6,2.6,1.6)\n  scov1m <- scov2m <- scov3m <- numeric(8)\n  up1 <- up2 <- up3 <- down1 <- down2 <- down3 <- numeric(8)\n  for(chromo in 1:1){\n    sample_range <- c(30,50,75,100,150,200,300,400)\n    scov1 <- NULL\n    scov2 <- NULL\n    scov3 <- NULL\n    sd1 <- NULL\n    sd2 <- NULL\n    sd3 <- NULL\n\n    for(sample in sample_range){\n      name <- paste0(\"C:/Users/tpook/Desktop/Small_Sample_test/Chr\", chromo, \"Choosen\",sample, \"Line\",race,\"Nsim10.RData\")\n      load(name)\n      scov1 <- cbind(scov1, cov1t)\n      scov2 <- cbind(scov2, cov2t)\n      scov3 <- cbind(scov3, cov3t)\n    }\n  }\n  scov1[scov1==0] <- NA\n  scov2[scov2==0] <- NA\n  scov3[scov3==0] <- NA\n\n  scov4 <- cbind(scov2[,1], scov3[,1], scov2[,2],scov3[,2],\n                 scov2[,3], scov3[,3], scov2[,4],scov3[,4],\n                 scov2[,5], scov3[,5], scov2[,6],scov3[,6],\n                 scov2[,7], scov3[,7], scov2[,8],scov3[,8])\n\n\n  ats <- sort(rep(1:8,2))\n  boxplot(scov4, at=ats,\n          col=rep(c(2,8),8), outcol=rep(c(2,1),8), xaxt=\"n\", ylab=\"\",xlab=\"training set (of 501)\",\n          ylim=c(0.43,0.94), main=\"Default settings:\")\n  title(ylab=\"coverage\", line=2.2)\n  axis(side=1, at=c(1+seq(0,by=diff,length.out = 8))[1:4*2-1], labels=sample_range[1:4*2-1],\n       xlab=\"training set (of 501)\")\n  axis(side=1, at=c(1+seq(0,by=diff,length.out = 8))[1:4*2], labels=sample_range[1:4*2],\n       xlab=\"training set (of 501)\")\n  par(mar=zwei)\n  scov1m <- scov2m <- scov3m <- numeric(8)\n  up1 <- up2 <- up3 <- down1 <- down2 <- down3 <- numeric(8)\n  for(chromo in 1:1){\n    sample_range <- c(30,50,75,100,150,200,300,400)\n    scov1 <- NULL\n    scov2 <- NULL\n    scov3 <- NULL\n    sd1 <- NULL\n    sd2 <- NULL\n    sd3 <- NULL\n\n    for(sample in sample_range){\n      name <- paste0(\"C:/Users/tpook/Desktop/Small_Sample_test/Chr\", chromo, \"Choosen\",sample, \"Line\",race,\"Nsim10_tarcov0.9.RData\")\n      load(name)\n      scov1 <- cbind(scov1, cov1t)\n      scov2 <- cbind(scov2, cov2t)\n      scov3 <- cbind(scov3, cov3t)\n    }\n  }\n  scov1[scov1==0] <- NA\n  scov2[scov2==0] <- NA\n  scov3[scov3==0] <- NA\n\n  scov4 <- cbind(scov2[,1], scov3[,1], scov2[,2],scov3[,2],\n                 scov2[,3], scov3[,3], scov2[,4],scov3[,4],\n                 scov2[,5], scov3[,5], scov2[,6],scov3[,6],\n                 scov2[,7], scov3[,7], scov2[,8],scov3[,8])\n\n\n  ats <- sort(rep(1:8,2))\n  boxplot(scov4, at=ats,\n          col=rep(c(2,8),8), outcol=rep(c(2,1),8), xaxt=\"n\", ylab=\"\",xlab=\"training set (of 501)\",\n          ylim=c(0.43,0.94), main=\"Fixed coverage in training set:\")\n  axis(side=1, at=c(1+seq(0,by=diff,length.out = 8))[1:4*2-1], labels=sample_range[1:4*2-1],\n       xlab=\"training set (of 501)\")\n  axis(side=1, at=c(1+seq(0,by=diff,length.out = 8))[1:4*2], labels=sample_range[1:4*2])\n  legend(\"bottomright\", c(\"training set\", \"test set\"), fill=c(8,2))\n\n  dev.off()\n}\n\nload(\"C:/Users/tpook/Desktop/R-Stuff/b123.RData\")\n\npng(file=\"C:/Users/tpook/Desktop/Fig6.png\", width=1559, height=1245, res=300)\n\npar(ps = 12, cex = 1, cex.main = 1, cex.lab=1, cex.axis=1)\npar(mar=c(5.1,4.1,2.1,2.1))\nct <- c(0.51,0.55,0.6,0.65,0.7,0.75,0.8,0.85,0.9,0.95,1)\ntype1 <- type2 <- type1b <- type2b <-  ci1 <- ci2 <- numeric(length(ct))\n\ntype1[1] <- 1 - (sum(b051_total[,3]) / sum(b051_total[,1]))\ntype2[1] <- (sum(b051_total[,2])-sum(b051_total[,3])) / (50*160*501 - sum(b051_total[,4]))\nci1[1] <- sd(b051_total[,3]/b051_total[,1])/sqrt(nrow(b051_total)) * 1.96\nci2[1] <- sd((b051_total[,2]-b051_total[,3])/(501-b051_total[,4]))/sqrt(nrow(b051_total)) * 1.96\ntype1b[1] <- 1 - (sum(b051_total[,6]) / sum(b051_total[,4]))\ntype2b[1] <- (sum(b051_total[,5])-sum(b051_total[,6])) / (50*160*501 - sum(b051_total[,4]))\n\ntype1[2] <- 1 - (sum(b055_total[,3]) / sum(b055_total[,1]))\ntype2[2] <- (sum(b055_total[,2])-sum(b055_total[,3])) / (50*160*501 - sum(b055_total[,4]))\nci1[2] <- sd(b055_total[,3]/b055_total[,1])/sqrt(nrow(b055_total)) * 1.96\nci2[2] <- sd((b055_total[,2]-b055_total[,3])/(501-b055_total[,4]))/sqrt(nrow(b055_total)) * 1.96\ntype1b[2] <- 1 - (sum(b055_total[,6]) / sum(b055_total[,4]))\ntype2b[2] <- (sum(b055_total[,5])-sum(b055_total[,6])) / (50*160*501 - sum(b055_total[,4]))\n\ntype1[3] <- 1 - (sum(b060_total[,3]) / sum(b060_total[,1]))\ntype2[3] <- (sum(b060_total[,2])-sum(b060_total[,3])) / (50*160*501 - sum(b060_total[,4]))\nci1[3] <- sd(b060_total[,3]/b060_total[,1])/sqrt(nrow(b060_total)) * 1.96\nci2[3] <- sd((b060_total[,2]-b060_total[,3])/(501-b060_total[,4]))/sqrt(nrow(b060_total)) * 1.96\ntype1b[3] <- 1 - (sum(b060_total[,6]) / sum(b060_total[,4]))\ntype2b[3] <- (sum(b060_total[,5])-sum(b060_total[,6])) / (50*160*501 - sum(b060_total[,4]))\n\ntype1[4] <- 1 - (sum(b065_total[,3]) / sum(b065_total[,1]))\ntype2[4] <- (sum(b065_total[,2])-sum(b065_total[,3])) / (50*160*501 - sum(b065_total[,4]))\nci1[4] <- sd(b065_total[,3]/b065_total[,1])/sqrt(nrow(b065_total)) * 1.96\nci2[4] <- sd((b065_total[,2]-b065_total[,3])/(501-b065_total[,4]))/sqrt(nrow(b065_total)) * 1.96\ntype1b[4] <- 1 - (sum(b065_total[,6]) / sum(b065_total[,4]))\ntype2b[4] <- (sum(b065_total[,5])-sum(b065_total[,6])) / (50*160*501 - sum(b065_total[,4]))\n\ntype1[5] <- 1 - (sum(b070_total[,3]) / sum(b070_total[,1]))\ntype2[5] <- (sum(b070_total[,2])-sum(b070_total[,3])) / (50*160*501 - sum(b070_total[,4]))\nci1[5] <- sd(b070_total[,3]/b070_total[,1])/sqrt(nrow(b070_total)) * 1.96\nci2[5] <- sd((b070_total[,2]-b070_total[,3])/(501-b070_total[,4]))/sqrt(nrow(b070_total)) * 1.96\ntype1b[5] <- 1 - (sum(b070_total[,6]) / sum(b070_total[,4]))\ntype2b[5] <- (sum(b070_total[,5])-sum(b070_total[,6])) / (50*160*501 - sum(b070_total[,4]))\n\ntype1[6] <- 1 - (sum(b075_total[,3]) / sum(b075_total[,1]))\ntype2[6] <- (sum(b075_total[,2])-sum(b075_total[,3])) / (50*160*501 - sum(b075_total[,4]))\nci1[6] <- sd(b075_total[,3]/b075_total[,1])/sqrt(nrow(b075_total)) * 1.96\nci2[6] <- sd((b075_total[,2]-b075_total[,3])/(501-b075_total[,4]))/sqrt(nrow(b075_total)) * 1.96\ntype1b[6] <- 1 - (sum(b075_total[,6]) / sum(b075_total[,4]))\ntype2b[6] <- (sum(b075_total[,5])-sum(b075_total[,6])) / (50*160*501 - sum(b075_total[,4]))\n\ntype1[7] <- 1 - (sum(b080_total[,3]) / sum(b080_total[,1]))\ntype2[7] <- (sum(b080_total[,2])-sum(b080_total[,3])) / (50*160*501 - sum(b080_total[,4]))\nci1[7] <- sd(b080_total[,3]/b080_total[,1])/sqrt(nrow(b080_total)) * 1.96\nci2[7] <- sd((b080_total[,2]-b080_total[,3])/(501-b080_total[,4]))/sqrt(nrow(b080_total)) * 1.96\ntype1b[7] <- 1 - (sum(b080_total[,6]) / sum(b080_total[,4]))\ntype2b[7] <- (sum(b080_total[,5])-sum(b080_total[,6])) / (50*160*501 - sum(b080_total[,4]))\n\ntype1[8] <- 1 - (sum(b085_total[,3]) / sum(b085_total[,1]))\ntype2[8] <- (sum(b085_total[,2])-sum(b085_total[,3])) / (50*160*501 - sum(b085_total[,4]))\nci1[8] <- sd(b085_total[,3]/b085_total[,1])/sqrt(nrow(b085_total)) * 1.96\nci2[8] <- sd((b085_total[,2]-b085_total[,3])/(501-b085_total[,4]))/sqrt(nrow(b085_total)) * 1.96\ntype1b[8] <- 1 - (sum(b085_total[,6]) / sum(b085_total[,4]))\ntype2b[8] <- (sum(b085_total[,5])-sum(b085_total[,6])) / (50*160*501 - sum(b085_total[,4]))\n\ntype1[9] <- 1 - (sum(b090_total[,3]) / sum(b090_total[,1]))\ntype2[9] <- (sum(b090_total[,2])-sum(b090_total[,3])) / (50*160*501 - sum(b090_total[,4]))\nci1[9] <- sd(b090_total[,3]/b090_total[,1])/sqrt(nrow(b090_total)) * 1.96\nci2[9] <- sd((b090_total[,2]-b090_total[,3])/(501-b090_total[,4]))/sqrt(nrow(b090_total)) * 1.96\ntype1b[9] <- 1 - (sum(b090_total[,6]) / sum(b090_total[,4]))\ntype2b[9] <- (sum(b090_total[,5])-sum(b090_total[,6])) / (50*160*501 - sum(b090_total[,4]))\n\ntype1[10] <- 1 - (sum(b095_total[,3]) / sum(b095_total[,1]))\ntype2[10] <- (sum(b095_total[,2])-sum(b095_total[,3])) / (50*160*501 - sum(b095_total[,4]))\nci1[10] <- sd(b095_total[,3]/b095_total[,1])/sqrt(nrow(b095_total)) * 1.96\nci2[10] <- sd((b095_total[,2]-b095_total[,3])/(501-b095_total[,4]))/sqrt(nrow(b095_total)) * 1.96\ntype1b[10] <- 1 - (sum(b095_total[,6]) / sum(b095_total[,4]))\ntype2b[10] <- (sum(b095_total[,5])-sum(b095_total[,6])) / (50*160*501 - sum(b095_total[,4]))\n\ntype1[11] <- 1 - (sum(b100_total[,3]) / sum(b100_total[,1]))\ntype2[11] <- (sum(b100_total[,2])-sum(b100_total[,3])) / (50*160*501 - sum(b100_total[,4]))\nci1[11] <- sd(b100_total[,3]/b100_total[,1])/sqrt(nrow(b100_total)) * 1.96\nci2[11] <- sd((b100_total[,2]-b100_total[,3])/(501-b100_total[,4]))/sqrt(nrow(b100_total)) * 1.96\ntype1b[11] <- 1 - (sum(b100_total[,6]) / sum(b100_total[,4]))\ntype2b[11] <- (sum(b100_total[,5])-sum(b100_total[,6])) / (50*160*501 - sum(b100_total[,4]))\n\nplot(ct, type1, type=\"l\", ylab=\"error rate\", xlab=\"minimum minor allele frequency to report\", lwd=2.5)\nlines(ct, type2, col=\"red\", lwd=2.5)\n\npolygon(c(ct,ct[11:1]), c(type1-ci1,(type1+ci1)[11:1]),\n        col=adjustcolor(\"black\",alpha.f=0.15), lty=0)\npolygon(c(ct,ct[11:1]), c(type2-ci2,(type2+ci2)[11:1]),\n        col=adjustcolor(\"red\",alpha.f=0.15), lty=0)\n\nlegend(\"topright\", c(\"Type I error\", \"Type II error\"), lty=c(1,1), col=c(1,2), lwd=c(2.5,2.5))\n\ndev.off()\n\n\n",
    "created" : 1531301682011.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3806129972",
    "id" : "E98EC047",
    "lastKnownWriteTime" : 1531301708,
    "last_content_update" : 1531301708987,
    "path" : "C:/Users/tpook/Desktop/Fig4&5&6.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 79,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}