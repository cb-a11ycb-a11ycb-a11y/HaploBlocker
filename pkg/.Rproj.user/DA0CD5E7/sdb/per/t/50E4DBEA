{
    "collab_server" : "",
    "contents" : "#' Function to plot a blocklist\n#'\n#' Function to plot a blocklist\n#' @param blocklist blocklist created by blocklist_calculcation algorithm\n#' @param cutoff2 minimum number of blocks to start/end to mark a recombination hotspot (default:5)\n#' @param bound_weighted weighted blocks in the detection of recombination hotspots according to size (default: TRUE)\n#' @param type length measure (default: \"window\" , alt: \"snp\", \"bp\")\n#' @export\n\n\nblocklist_plot <- function(blocklist, cutoff2 = 5, bound_weighted=TRUE, type=\"snp\" ){\n  size <- blocklist_size(blocklist)\n  se <- blocklist_startend(blocklist, type=type)\n  nwindow <- max(se)\n\n  bpstart <- se[,1]\n  bpend <- se[,2]\n\n  switch <- sort(bpstart, decreasing=FALSE, index.return=TRUE)$ix\n  start <- bpstart[switch]\n  end <- bpend[switch]\n  size <- size[switch]\n  plot(-1000,0, xlim=c(1,length(start)), ylim=c(0, max(end)), xlab=\"block number\", ylab=\"SNP\")\n  for(index in 1:length(start)){\n    lines(c(index,index), c(start[index], end[index]))\n  }\n\n  if(bound_weighted==TRUE){\n    tempest <- numeric(sum(size)*2)\n    sofar <- 0\n    for(index in 1:length(start)){\n      tempest[1:size[index]+sofar] <- start[index]\n      sofar <- sofar + size[index]\n    }\n    for(index in 1:length(start)){\n      tempest[1:size[index]+sofar] <- end[index]\n      sofar <- sofar + size[index]\n    }\n    xy <- density(tempest,bw=5, from=1, to=nwindow, n=nwindow)\n\n    candidate <- unique(c(0,(c(0,xy$y[-nwindow])<c(xy$y)) * (c(xy$y)>c(xy$y[-1],0)) * (xy$y > 1/length(start)/2/5/2*cutoff2) * 1:nwindow))[-1]\n\n    abline(h=candidate)\n  } else{\n    xy <- density(c(start,end),bw=5, from=1, to=nwindow, n=nwindow)\n\n    candidate <- unique(c(0,(c(0,xy$y[-nwindow])<c(xy$y)) * (c(xy$y)>c(xy$y[-1],0)) * (xy$y > 1/length(start)/2/5/2*cutoff2) * 1:nwindow))[-1]\n\n    abline(h=candidate)\n  }\n}\n",
    "created" : 1528881323603.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "197332571",
    "id" : "50E4DBEA",
    "lastKnownWriteTime" : 1528881391,
    "last_content_update" : 1528881391859,
    "path" : "C:/Users/tpook/Desktop/R-Stuff/HaploBlocker/R/blocklist_plot.R",
    "project_path" : "R/blocklist_plot.R",
    "properties" : {
        "tempName" : "Untitled3"
    },
    "relative_order" : 91,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}